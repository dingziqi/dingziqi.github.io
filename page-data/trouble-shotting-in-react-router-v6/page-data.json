{"componentChunkName":"component---src-templates-blog-post-js","path":"/trouble-shotting-in-react-router-v6/","result":{"data":{"site":{"siteMetadata":{"title":"D.Z"}},"markdownRemark":{"id":"0e778ab5-45b7-5581-8e55-2efcce068a48","excerpt":"最近的项目是基于 create-react-app 官方模板进行定制，以便统一公司内部的 react 相关技术栈，避免“百花齐放”。由于是新项目模板，所以在项目中直接内置了 ，本以为这个项目已经那么成熟应该不会有坑了，结果却是一坑接一坑。下面就是一些踩坑实录。 放弃类组件支持 在函数组件的道路上，reactr…","html":"<p>最近的项目是基于 create-react-app 官方模板进行定制，以便统一公司内部的 react 相关技术栈，避免“百花齐放”。由于是新项目模板，所以在项目中直接内置了 <code class=\"language-text\">react-router-dom@6.x</code>，本以为这个项目已经那么成熟应该不会有坑了，结果却是一坑接一坑。下面就是一些踩坑实录。</p>\n<h2>放弃类组件支持</h2>\n<p>在函数组件的道路上，reactr-router-dom 属实激进，在 6.x 的版本里直接只提供 hook 形式的 api。这样的做法完全没有考虑旧代码的兼容和我们这种没有推广开 hooks 的开发团队。不过问题不大，官方不提供 <code class=\"language-text\">withRouter</code>，那我们自己实现一个好了。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useSearchParams<span class=\"token punctuation\">,</span> useLocation<span class=\"token punctuation\">,</span> useNavigate <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-router-dom\"</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">withRouter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">WrappedComponent</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token function\">WithRouter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>params<span class=\"token punctuation\">,</span> setParams<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useSearchParams</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> navigate <span class=\"token operator\">=</span> <span class=\"token function\">useNavigate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> location <span class=\"token operator\">=</span> <span class=\"token function\">useLocation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>WrappedComponent\n        params<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>params<span class=\"token punctuation\">}</span>\n        setParams<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>setParams<span class=\"token punctuation\">}</span>\n        navigate<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>navigate<span class=\"token punctuation\">}</span>\n        location<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>locatoin<span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"title":"react-router@v6中的踩坑记录","date":"05-16, 2022","description":null,"tags":"踩坑"}},"previous":{"fields":{"slug":"/issues-with-aliyun-oss/"},"frontmatter":{"title":"阿里云OSS使用的一些问题记录"}},"next":null},"pageContext":{"id":"0e778ab5-45b7-5581-8e55-2efcce068a48","previousPostId":"8882e676-9cf6-53c8-ad5b-248fec05a620","nextPostId":null}},"staticQueryHashes":["2841359383"]}